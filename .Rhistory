ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill=UserName,
size= ifelse(PCOA$UserName %in% id == TRUE,15,12),
color = ifelse(PCOA$UserName %in% id == TRUE, "black","grey")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
#create PCOA plot of beta diversities of pertinent subjects
betad<-vegdist(betataxa, method="bray", binary=FALSE, diag=FALSE, upper=FALSE,
na.rm = FALSE)
#betad as matrix
betad <- as.matrix(dist(betad))
#column name is "IDs"
IDs <-colnames(betad)
# Run the pcoa() function on the beta diversity table, and store the vectors generated as a dataframe
PCOA <- data.frame(pcoa(betad)$vectors)
#create vector with placeholders
new_names <- rep("",ncol(PCOA))
#create for loop which gives column names (currently named "axis") the name of PC1, PC2, PC3.. so forth
#Each column for the PCOA matrix is a new PC (number).
for(i in 1:ncol(PCOA)){
new_names[i] <- paste("PC",i,sep="")
}
#code above uses a for loop - from the range of 1 to the number of columns in the PCOA
#matrix, the for loop accesses the new name variable and names it PC + i (which is 1,2,3  depending on column
#as indicated by for loop - for loop increases in increments of 1 (i goes up by 1) and goes thru columns)
#new_names (PC1, PC2, etc..) replace the current colnames
names(PCOA) <- new_names
#creates column that is sampleID
PCOA$X.SampleID <- IDs
#merge map and PCOA by SampleID - select both lines and run together - won't work otherwise
PCOA <- merge(PCOA, map, by = 'X.SampleID')
#PCOA <- merge(PCOA, map, by = 'UserName')
#### Plot PCOA ####
#instantiate shape and color palettes
shape_pal <- c(1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8)
shape_pal2 <- c(1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3)
shape_pal3 <- c(15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18)
colpal<- colorRampPalette(brewer.pal(12,"Set3"))
colpal<- sample(colpal(length(unique(PCOA$UserName))))
id <- gsub("_", " ",id)
# PCOA[PCOA$UserName %in% id,]
#dt[dt$fct %in% vc,]
#PCOA1<- PCOA[PCOA$UserName %in% id,]
#dubloon %>% filter(value==TRUE)
#filter(PCOA, UserName %in% id)
#use ggplot to plot
ggplot(PCOA) +
geom_point(aes(x=PC1,y=PC2, col=UserName, shape=UserName,
size=ifelse(PCOA$UserName %in% id == TRUE,15,5)),
alpha=1,
stroke=3) + #gives axes and item of focus
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(col = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE) +
scale_shape_manual(values=shape_pal3) +
scale_color_manual(values=colpal)+
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill=UserName,
size= ifelse(PCOA$UserName %in% id == TRUE,15,12),
color = ifelse(PCOA$UserName %in% id == TRUE, "black","grey")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill=UserName,
size= ifelse(PCOA$UserName %in% id == TRUE,15,12),
color = ifelse(PCOA$UserName %in% id == TRUE, "black","grey")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","others")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
library(ellipse)
centroids <- aggregate(cbind(PCOA$PC1, PCOA$PC2)~UserName, sc, mean)
?aggregate()
centroids <- aggregate(cbind(PC1, PC2)~UserName, PCOA, mean)
View(centroids)
library(ellipse)
install.packages("ellipse")
install.packages("ellipse")
library(ellipse)
library(ellipse)
centroids <- aggregate(cbind(PC1, PC2)~UserName, PCOA, mean)
conf.rgn <
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
#stat_ellipse(alpha = 0.3, geom="polygon", linetype=2, aes(x = PC1, y = PC2, fill = PCOA$UserName %in% id))+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
conf.rgn <- do.call(rbind,lapply(unique(PCOA$UserName), function(t)
data.frame(UserName=as.character(t),
ellipse(cov(PCOA[PCOA$UserName==t,1:2]),
centre = as.matrix(centroids[t,2:3]),
level = 0.95),
stringsAsFactors = FALSE)))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse()+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(mapping = UserName)+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(aes(x=PC1, y = PC2, UserName)+
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2)) +
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(aes(x=PC1, y = PC2, color = UserName)) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
PCOA$UserName
PCOA <- droplevels(PCOA)
ggplot(PCOA, aes(x = PC1, y = PC2)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(aes(x=PC1, y = PC2, color = UserName)) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
PCOA$User
ggplot(PCOA, aes(x = PC1, y = PC2, group = UserName)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse() +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
PCOA <- PCOA %>% mutate(User = ifelse(UserName == id, "self", "other"))
PCOA$User
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse() +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,
size = ifelse(PCOA$UserName %in% id == TRUE,15,7),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey") +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName),
color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey") +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(size=3,alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey") +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey") +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 3) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE, nrow = 4) +
theme_classic(base_family = "Helvetica") +
theme(legend.position = "bottom",
plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName,color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE, ncol = 1) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE, ncol = 3) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
geom_point(data = subset(PCOA, PCOA$User == "self"), aes(PC1, PC2))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
geom_point(data = subset(PCOA, PCOA$User == "self"), aes(PC1, PC2))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
geom_point(data = subset(PCOA, PCOA$User == "self"), aes(PC1, PC2)) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
PCOA <- PCOA %>% mutate(User = ifelse(UserName == id, "self", "other"))
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
geom_point(data = subset(PCOA, PCOA$User == "self"), aes(PC1, PC2)) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
geom_point(data = subset(PCOA, PCOA$User == "self"), aes(PC1, PC2)) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
PCOA$User
PCOA <- POCA[order(POCA$User)]
PCOA <- POCA[order(POCA$User),]
PCOA <- PCOA[order(PCOA$User),]
PCOA$User
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
View(food_map)
food_map <- food_map[,!(colnames(food_map) %in% outliers)]
View(food_map)
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
colpal <- colorRampPalette(brewer.pal(12,"Set3"))
colpal <- sample(colpal,3,replace = FALSE)
colpal <- colorRampPalette(brewer.pal(12,"Set3"))
colpal <- sample(colpal,3)
colpal <- sample(colpal,3)
9
9
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
signif(mean(subnutr$FIBE),2)
?round()
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
source('~/Documents/Projects/zebra/bin/pc_version.R', echo=TRUE)
