betad <- as.matrix(dist(betad))
#column name is "IDs"
IDs <-colnames(betad)
# Run the pcoa() function on the beta diversity table, and store the vectors generated as a dataframe
PCOA <- data.frame(pcoa(betad)$vectors)
#create vector with placeholders
new_names <- rep("",ncol(PCOA))
#create for loop which gives column names (currently named "axis") the name of PC1, PC2, PC3.. so forth
#Each column for the PCOA matrix is a new PC (number).
for(i in 1:ncol(PCOA)){
new_names[i] <- paste("PC",i,sep="")
}
#code above uses a for loop - from the range of 1 to the number of columns in the PCOA
#matrix, the for loop accesses the new name variable and names it PC + i (which is 1,2,3  depending on column
#as indicated by for loop - for loop increases in increments of 1 (i goes up by 1) and goes thru columns)
#new_names (PC1, PC2, etc..) replace the current colnames
names(PCOA) <- new_names
#creates column that is sampleID
PCOA$X.SampleID <- IDs
#merge map and PCOA by SampleID - select both lines and run together - won't work otherwise
PCOA <- merge(PCOA, map, by = 'X.SampleID')
#### Plot PCOA ####
#instantiate shape and color palettes
# shape_pal <- c(1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8)
# shape_pal2 <- c(1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3)
# shape_pal3 <- c(15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18)
colpal<- colorRampPalette(brewer.pal(12,"Set3"))
colpal<- sample(colpal(length(unique(PCOA$UserName))))
id <- gsub("_", " ",id)
# make a variable for self/other to use for plotting
PCOA <- PCOA %>% mutate(User = ifelse(UserName == id, "self", "other"))
# sort data frame so that the values matching id are at the bottom and plotted last
PCOA <- PCOA[order(PCOA$User),]
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(breaks = id, values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
source('~/Documents/Projects/zebra/bin/makepdf.R', echo=TRUE)
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("black", NA)) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("black", "white")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
#create PCOA plot of beta diversities of pertinent subjects
betad<-vegdist(betataxa, method="bray", binary=FALSE, diag=FALSE, upper=FALSE,
na.rm = FALSE)
#betad as matrix
betad <- as.matrix(dist(betad))
#column name is "IDs"
IDs <-colnames(betad)
# Run the pcoa() function on the beta diversity table, and store the vectors generated as a dataframe
PCOA <- data.frame(pcoa(betad)$vectors)
#create vector with placeholders
new_names <- rep("",ncol(PCOA))
#create for loop which gives column names (currently named "axis") the name of PC1, PC2, PC3.. so forth
#Each column for the PCOA matrix is a new PC (number).
for(i in 1:ncol(PCOA)){
new_names[i] <- paste("PC",i,sep="")
}
#code above uses a for loop - from the range of 1 to the number of columns in the PCOA
#matrix, the for loop accesses the new name variable and names it PC + i (which is 1,2,3  depending on column
#as indicated by for loop - for loop increases in increments of 1 (i goes up by 1) and goes thru columns)
#new_names (PC1, PC2, etc..) replace the current colnames
names(PCOA) <- new_names
#creates column that is sampleID
PCOA$X.SampleID <- IDs
#merge map and PCOA by SampleID - select both lines and run together - won't work otherwise
PCOA <- merge(PCOA, map, by = 'X.SampleID')
#### Plot PCOA ####
#instantiate shape and color palettes
# shape_pal <- c(1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8,1,2,3,4,5,6,7,8)
# shape_pal2 <- c(1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3,1,2,3)
# shape_pal3 <- c(15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18,15,19,17,18)
colpal<- colorRampPalette(brewer.pal(12,"Set3"))
colpal<- sample(colpal(length(unique(PCOA$UserName))))
id <- gsub("_", " ",id)
# make a variable for self/other to use for plotting
PCOA <- PCOA %>% mutate(User = ifelse(UserName == id, "self", "other"))
# sort data frame so that the values matching id are at the bottom and plotted last
PCOA <- PCOA[order(PCOA$User),]
ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = UserName, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_manual(breaks = id, values = colpal) +
scale_color_manual(values = c("black", "grey")) +
scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title=paste0("Beta diversity of your gut microbiome - PCoA -  ", id)) +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("black", "white")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("dark grey", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("white", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("white", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("white", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("white", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("white", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
grad1<- c("#fee6ce", "#fdae6b", "#e6550d")
grad2<- c("#deebf7", "#9ecae1", "#3182bd")
grad3<- c("#e5f5e0", "#a1d99b", "#31a354")
grad4<- c("#efedf5", "#bcbddc", "#756bb1")
Bact <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Bacteroidetes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad1) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Bacteroidetes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Firm <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Firmicutes, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad2) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Firmicutes") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Prot <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Proteobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad3) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Proteobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
Actin <- ggplot(PCOA, aes(x = PC1, y = PC2, group = User)) +
geom_point(aes(fill = Actinobacteria, color = ifelse(PCOA$UserName %in% id == TRUE, "you","z")),
alpha=1, pch = 21, size = 5) +
scale_fill_gradientn(colors = grad4) +
scale_color_manual(values = c("black", "dark grey")) +
#scale_shape_manual(values = shape_pal3) +
stat_ellipse(color = "dark grey", type = "norm", linetype = 2, level = 0.95) +
labs(title="Relative Abundance of Actinobacteria") +
guides(fill = guide_legend(override.aes = list(alpha=1)), size = FALSE, col = FALSE) +
#guides(size = FALSE, fill = FALSE) +
theme_classic(base_family = "Helvetica") +
theme(plot.title = element_text(size = 14, hjust = 0.5),
legend.position = "bottom")
plot_grid(Bact, Firm, Prot, Actin, nrow = 2, ncol = 2 )
source('~/Documents/Projects/zebra/bin/makepdf.R', echo=TRUE)
source('~/Documents/Projects/zebra/bin/makepdf.R', echo=TRUE)
